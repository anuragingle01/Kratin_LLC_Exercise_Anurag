<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medication Reminder</title>
</head>
<body>
    <h1>Medication Reminder</h1>
    
    <form id="medicationForm" th:action="@{/api/medications}" method="post">
        <!-- Medication Form Fields -->
        <label for="medicationName">Medication Name:</label>
        <input type="text" id="medicationName" name="name" th:required="true"><br>

        <label for="dosage">Dosage:</label>
        <input type="text" id="dosage" name="dosage" th:required="true"><br>

        <label for="timing">Timing:</label>
        <input type="text" id="timing" name="timing" th:required="true"><br>

        <label for="phoneNumber">Phone Number:</label>
        <input type="text" id="phoneNumber" name="phoneNumber" th:required="true"><br>

        <button type="submit">Save Medication</button>
    </form>

    <hr>

    <h2>Medication List</h2>
    <ul>
        <li th:each="medication : ${medications}">
            <span th:text="${medication.name}"></span>
            <span th:text="${medication.dosage}"></span>
            <span th:text="${medication.timing}"></span>
            <span th:text="${medication.phoneNumber}"></span>
        </li>
    </ul>

    <script th:inline="javascript">
        /* Fetch Medications from the API */
        fetch('/api/medications')
            .then(response => response.json())
            .then(data => {
                /* Set medications in the Thymeleaf context for rendering */
                var medications = data;
                /* Render medications */
                var medicationsElement = document.getElementById('medications');
                medicationsElement.innerHTML = '';
                medications.forEach(function(medication) {
                    var li = document.createElement('li');
                    li.textContent = medication.name + ' - ' + medication.dosage + ' - ' + medication.timing + ' - ' + medication.phoneNumber;
                    medicationsElement.appendChild(li);
                });
            })
            .catch(error => console.error('Error fetching medications:', error));
    </script>
</body>
</html>
